---
title: 线程池参数分析
date: 2019-3-06 07:51:52
categories: 线程池
tags: [线程池参数]
---

> 一直在使用线程池创建线程，但是线程池的参数有什么用呢？<!--more-->

#### 参数概念

1. corePoolSize：线程池中一直存活者的线程的最小数量。
2. maximumPoolSize：线程池内能够容纳线程数量的最大值，但是如果提供的阻塞队列（也就是参数workQueue）是一个无界队列，那么提供的maximumPoolSize的数值将毫无意义。
3. keepAliveTime：空闲线程处于等待状态的超时时间。如果执行的任务相对较多，并且每个任务执行的时间比较短，那么可以为该参数设置一个相对较大的数值，以提高线程的利用率。如果执行的任务相对较少，线程池使用率相对较低，那么可以先将参数设置为一个较小的数值，通过超时停止的机制来降低系统线程资源的开销，后续如果发现线程池的使用率逐渐增高以后，线程池会根据当前调教的任务数自动创建新的线程，当然，也可以手动调用setKeepAliveTime（long， TimeUnit)方法来重新设定keepAliveTime字段的值。
4. workQueue：workQueue是一个内部元素为Runable(各种任务，通常是异步任务)的阻塞队列。阻塞队列是一种类似于“生产者-消费者”模型的队列。当队列已满时如果继续向队列中插入元素，该插入操作将被阻塞一直处于等待状态，知道队列中有元素被移除产生空位子后，才有可能执行这次插入操作；当队列为空时，如果继续执行元素的删除或获取操作，该操作同样会被阻塞而进入等待状态，直到队列中又有了该元素后，才能执行该操作。

#### 线程池操作

1. 如果线程池中正在运行的线程数少于核心线程数，那么线程池总是倾向于创建一个新线程来执行该任务，而不是将该任务提交到该队列workQueue中进行等待。
2. 如果线程池中正在运行的线程数不少于核心线程数，那么线程池总是倾向于将该任务提交到队列workQueue中先让其等待，而不是创建一个新线程来执行该任务。
3. 如果线程池中正在运行的线程数不少于核心线程数，并且线程池中的阻塞队列也满了使得该任务入队失败，那么线程池会去判断当前池子中运行的线程数是否已经等于了该线程池允许运行的最大线程数maximumPoolSize，如果发现已经等于了，说明线程池已满，无法在继续创建新的线程了，那么就会拒绝执行该任务。如果发现运行的线程数小于池子允许的最大线程数，那么就会创建一个线程（创建的线程是非核心线程）来执行该任务。